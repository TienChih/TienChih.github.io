<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>SageMathCell</title>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Activate'});
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
                           evalButtonText: 'Evaluate'});
    </script>
  </head>
  <body>
  
    <div class="compute"><script type="text/x-sage">
def MakeFS(P, GenSet):
    RM = GenSet

    for y in P:
        if (y,y) not in RM:
            RM.append( (y,y) )

    #Pullback
    TempRM = []
    while(TempRM != RM):
        TempRM = RM
        for x in RM:
            for y in P:
                if P.is_less_than(y,x[1]):
                    if (P.meet(x[0],y), y) not in RM:
                        RM.append( (P.meet(x[0],y), y) )


    #Composition
    TempRM = []
    while(TempRM != RM):
        TempRM = RM
        for x1 in RM:
            for x2 in RM:
                if x1[1] == x2[0]:
                    dummy = 1
                    for z in RM:
                        if z == (x1[0], x2[1]):
                            dummy = 0
                    if dummy == 1:
                        RM.append( (x1[0], x2[1]) )

    #Compute E(R)

    ER = []

    for r in RM:
        if r[0] != r[1]:
            for x in P:
                if P.is_less_than(x,r[0]) or x == r[0]:
                    dummy = 1
                    for s in ER:
                        if (x, r[1]) == s:
                            dummy = 0
                    if dummy == 1:
                        ER.append( (x, r[1]) )

    #Compute E(R)^c
    LM=[]

    for x in P:
        for y in P:
            if P.is_less_than(x,y) or x == y:
                dummy = 1
                for r in ER:
                    if (x,y) == r:
                        dummy = 0
                if dummy == 1:
                    LM.append( (x, y) )
    return( (LM,RM) )
                    

def MakeMaxComp(P, RM):
    RMp = []
    for e in RM:
        A = e[0]
        B = e[1]
        dummy = True
        for C1 in P:
            for C2 in P:
                if P.is_less_than(C1, C2):
                    if (P.is_less_than(C2, B) or C2 == B):
                        if (P.meet(C1, A), P.meet(C2, A)) in RM:
                            #print([(P.meet(C1, A), P.meet(C2, A)), (C1,C2)])
                            #dummy = ((C1, C2) in RM)
                            if (C1, C2) not in RM:
                                dummy = False
                            #print(dummy)    
        if dummy and (A,B) not in RMp:
            RMp.append((A,B))
    return(RMp)                        
    
def removeid(S):
    St = []
    for x in S:
        if x[0] != x[1]:
            St.append(x)
    return(St)        
    
P = LatticePoset({0: ['a', 'b'], 'a': ['c', 'd'], 'b': ['d','e'], 'c': [1], 'd': [1], 'e': [1]})

#P = P.dual()

P.show()

GenSet = [('e',1)]

LM = MakeFS(P, GenSet)[0]
RM = MakeFS(P, GenSet)[1]

RMp = MakeMaxComp(P, RM)
LMp = MakeFS(P, RMp)[0]
                
print("The Right Morphisms are: ",removeid(RM))
print("The Left Morphisms are: ", removeid(LM))
print("The Right Morphisms of Max Compatible are: ", removeid(RMp))
print("The Left Morphisms of Max Compatible are: ", removeid(LMp))

set(RM) == set(RMp)
 </script></div>
    
  </body>
</html>